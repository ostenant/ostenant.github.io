
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇) | Coding | Harrison&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="baidu-site-verification" content="0aFfZiB4tV" />
  
  
  <meta name="description" content="前言上文介绍了SOFA-RPC 的几种调用方式，包括单向调用、同步调用、Future调用、回调，引入了泛化调用和过滤器。本文将对 SOFA-RPC 的高级功能，包括参数配置、自定义线程池、预热权重和自动故障剔除等。">
<meta name="keywords" content="RPC,SOFA-Boot,SOFA_RPC">
<meta property="og:type" content="article">
<meta property="og:title" content="蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)">
<meta property="og:url" content="https://ostenant.coding.me/2018/05/12/蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)/index.html">
<meta property="og:site_name" content="Coding | Harrison&#39;s Blog">
<meta property="og:description" content="前言上文介绍了SOFA-RPC 的几种调用方式，包括单向调用、同步调用、Future调用、回调，引入了泛化调用和过滤器。本文将对 SOFA-RPC 的高级功能，包括参数配置、自定义线程池、预热权重和自动故障剔除等。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/SOFA.JPG">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/10548396-035e78bdc34c7525?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-05-12T15:18:18.458Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)">
<meta name="twitter:description" content="前言上文介绍了SOFA-RPC 的几种调用方式，包括单向调用、同步调用、Future调用、回调，引入了泛化调用和过滤器。本文将对 SOFA-RPC 的高级功能，包括参数配置、自定义线程池、预热权重和自动故障剔除等。">
<meta name="twitter:image" content="http://ols3fdyll.bkt.clouddn.com/SOFA.JPG">
  
    <link rel="alternative" href="/atom.xml" title="Coding | Harrison&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
 
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Coding | Harrison&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">上善若水任方猿</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="https://github.com/ostenant">Github</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="ostenant.coding.me">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/12/蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)/" class="article-date">
  <time datetime="2018-05-12T12:12:00.000Z" itemprop="datePublished">2018-05-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/RPC通信框架系列/">RPC通信框架系列</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上文介绍了SOFA-RPC 的几种调用方式，包括单向调用、同步调用、Future调用、回调，引入了泛化调用和过滤器。本文将对 SOFA-RPC 的高级功能，包括参数配置、自定义线程池、预热权重和自动故障剔除等。</p>
<a id="more"></a>
<p><img src="http://ols3fdyll.bkt.clouddn.com/SOFA.JPG" alt=""></p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="1-参数配置"><a href="#1-参数配置" class="headerlink" title="1. 参数配置"></a>1. 参数配置</h2><p><code>SOFABoot RPC Starter</code> 提供了方便的参数设置方式。这些参数目前可以分为两个部分。一部分是如端口，注册中心地址等配置，这类配置在 <code>application.properties</code> 中。另一部分是如超时时间等配置，这类配置在 <code>XML</code> 中。</p>
<h3 id="XML-配置"><a href="#XML-配置" class="headerlink" title="XML 配置"></a>XML 配置</h3><ul>
<li><strong>调用超时时间</strong></li>
</ul>
<p>如下是设置超时时间的方式，单位为 ms ，如果调用超过了这个时间则会抛出异常。服务端和客户端都可以设置，以客户端的超时时间设置优先。默认客户端为 3000 ，目前对 bolt，rest，dubbo 生效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">timeout</span>=<span class="string">"5000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>获取地址等待时间</strong></li>
</ul>
<p>如下是设置获取地址等待时间，单位为ms。在启动时如果服务引用方等待超过了这个时间则不会再等待地址，会继续启动。客户端设置，默认为-1，表示会一直等待到地址为止。目前对 bolt，rest 生效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">address-wait-time</span>=<span class="string">"30000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>建立连接超时时间</strong></li>
</ul>
<p>如下是设置建立连接超时时间，单位为 ms 。在建立连接时如果耗时超过了这个时间则会抛出异常。客户端设，默认为 5000。目前对 bolt，rest 生效。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">connect.timeout</span>=<span class="string">"30000"</span></span></span><br><span class="line">&lt;/sofa:binding.bolt&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>权重</strong></li>
</ul>
<p>如下是设置权重。客户端在发起调用时，如果采用的算法是随机调用，则会根据该权重来进行随机。服务端设置，默认为 100。目前对 bolt 生效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">weight</span>=<span class="string">"200"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>lazy 连接</strong></li>
</ul>
<p>默认情况下客户端在注册中心推送地址到客户端时，就立即建立好连接，这个过程通常是在第一次调用之前进行的。如果设置服务引用的属性 lazy 为 true，客户端在第一次调用时才和所要调用的远程地址建立连接。默认为 false。</p>
<p>如下设置 lazy 连接方式，将 lazy 属性设为 true。目前支持 bolt 和 dubbo 协议。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:reference</span> <span class="attr">id</span>=<span class="string">"lazyServiceReferenceBolt"</span> <span class="attr">interface</span>=<span class="string">"com.ostenant.sofa.rpc.example.lazy.LazyService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">lazy</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>check 属性</strong></li>
</ul>
<p>默认情况下客户端在启动时，服务引用不要求存在可用的地址和连接。如果设置服务引用的属性 check 为 true，客户端在启动时，服务引用会检查是否存在对应的地址和连接，如果不存在会抛出异常。默认为 false。</p>
<p>如下设置 check 连接方式，将 check 属性设为 true。目前支持 bolt 和 dubbo 协议。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:reference</span> <span class="attr">id</span>=<span class="string">"checkServiceReferenceBolt"</span> <span class="attr">interface</span>=<span class="string">"com.ostenant.sofa.rpc.example.check.CheckService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">check</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>重试次数</strong></li>
</ul>
<p>重试次数，即在第一次调用失败后重试的最大次数，如果重试成功则不再继续重试。默认为 0。如下设置调用次数，利用 retries 属性指定重试次数。目前支持 bolt 和 dubbo 协议。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:reference</span> <span class="attr">id</span>=<span class="string">"retriesServiceReferenceBolt"</span> <span class="attr">interface</span>=<span class="string">"com.ostenant.sofa.rpc.example.retries.RetriesService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">retries</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>负载均衡</strong></li>
</ul>
<p>如下选择负载均衡的方式，利用 loadBalancer 属性指定调用时候使用的负载均衡策略，默认为 random。</p>
<p>目前支持 random，localPref，roundRobin，consistentHash，weightRoundRobin 五种负载均衡策略，具体可见 SOFARPC 负载均衡相关介绍。目前支持bolt协议。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:reference</span> <span class="attr">id</span>=<span class="string">"loadBalancerServiceReference"</span> <span class="attr">interface</span>=<span class="string">"com.ostenant.sofa.rpc.example.loadBalancer.LoadBalancerService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">loadBalancer</span>=<span class="string">"random"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>方法级别配置</strong></li>
</ul>
<p>如下，sofa:method 元素是方法级别的配置。方法级别的配置优先级比服务级别的更高。name 属性指定了方法的名字。支持调用超时时间，调用方式，回调类的设置。方法级别的配置与服务级别的配置所生效的协议一样。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:method</span> <span class="attr">name</span>=<span class="string">"sayMethod"</span> <span class="attr">timeout</span>=<span class="string">"3000"</span> <span class="attr">type</span>=<span class="string">"sync"</span> <span class="attr">callback-ref</span>=<span class="string">"xxx"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Properties-配置"><a href="#Properties-配置" class="headerlink" title="Properties 配置"></a>Properties 配置</h3><table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">spring.application.name</td>
<td style="text-align:left">应用名</td>
<td style="text-align:left"></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">logging.path</td>
<td style="text-align:left">日志路径</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">logging.level.com.alipay.sofa.rpc.boot</td>
<td style="text-align:left">sofa-rpc-boot-start的日志级别(starter自身的日志)</td>
<td style="text-align:left">info</td>
</tr>
<tr>
<td style="text-align:left">logging.level.com.alipay.sofa.rpc</td>
<td style="text-align:left">sofa-rpc的日志级别(sofa-rpc核心日志基本在这里)</td>
<td style="text-align:left">info</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.bolt.port</td>
<td style="text-align:left">bolt 端口</td>
<td style="text-align:left">22000</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.bolt.io.thread.count</td>
<td style="text-align:left">bolt 的 io 线程数</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.bolt.executor.thread.count</td>
<td style="text-align:left">bolt 的业务线程最大值</td>
<td style="text-align:left">200</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.bolt.accepts.count</td>
<td style="text-align:left">bolt 能够支持的最大长连接数</td>
<td style="text-align:left">100000</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.hostname</td>
<td style="text-align:left">rest 的 hostname</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.port</td>
<td style="text-align:left">rest 端口</td>
<td style="text-align:left">8341</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.io.thread.count</td>
<td style="text-align:left">rest 的 io 线程数</td>
<td style="text-align:left">cpu 核数 * 2</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.executor.thread.count</td>
<td style="text-align:left">rest 的业务线程数</td>
<td style="text-align:left">200</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.max.request.size</td>
<td style="text-align:left">rest 的最大 byte 请求长度</td>
<td style="text-align:left">1024 <em> 1024 </em> 10</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.telnet</td>
<td style="text-align:left">rest 是否支持 telnet</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.rest.daemon</td>
<td style="text-align:left">rest 是否支持 daemon</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.dubbo.port</td>
<td style="text-align:left">dubbo 的端口</td>
<td style="text-align:left">20880</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.dubbo.io.thread.count</td>
<td style="text-align:left">dubbo 的 io 线程数</td>
<td style="text-align:left">cpu 核数 + 1</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.dubbo.executor.thread.count</td>
<td style="text-align:left">dubbo 的业务线程数</td>
<td style="text-align:left">100</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.dubbo.accepts.count</td>
<td style="text-align:left">dubbo能够支持的最大长连接数</td>
<td style="text-align:left">0，表示不限制</td>
</tr>
</tbody>
</table>
<h2 id="2-自定义线程池"><a href="#2-自定义线程池" class="headerlink" title="2. 自定义线程池"></a>2. 自定义线程池</h2><p>SOFA-RPC 支持自定义业务线程池。可以为指定服务设置一个独立的业务线程池，和 SOFA-RPC 自身的业务线程池是隔离的，多个服务可以共用一个独立的线程池。目前支持 bolt 协议。</p>
<p>在 SOFA-Boot 环境中可以为一个服务设置一个自定义线程池，配置如下：</p>
<ul>
<li><strong>声明自定义线程池</strong></li>
</ul>
<p>如下声明一个自定义线程池，<code>class</code> 必须为 <code>com.alipay.sofa.rpc.server.UserThreadPool</code>，这是 <code>SOFA-RPC</code> 提供的类，<code>init-method=&quot;init&quot;</code> 也必须声明以进行初始化。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"customerThreadPool"</span> <span class="attr">class</span>=<span class="string">"com.alipay.sofa.rpc.server.UserThreadPool"</span> <span class="attr">init-method</span>=<span class="string">"init"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"corePoolSize"</span> <span class="attr">value</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maximumPoolSize"</span> <span class="attr">value</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"queueSize"</span> <span class="attr">value</span>=<span class="string">"5"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"threadPoolName"</span> <span class="attr">value</span>=<span class="string">"customerThreadPool_name"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>为服务设置自定义线程池</strong></li>
</ul>
<p>如下通过 <code>sofa:global-attrs</code> 元素的 <code>thread-pool-ref</code> 属性为该服务设置自定义线程池。<code>customerThreadPool</code> 是上面自定义线程池的 <code>bean id</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"threadPoolServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.ostenant.sofa.rpc.example.threadpool.ThreadPoolServiceImpl"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sofa:service</span> <span class="attr">ref</span>=<span class="string">"threadPoolServiceImpl"</span> <span class="attr">interface</span>=<span class="string">"com.alipay.sofa.rpc.samples.threadpool.ThreadPoolService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">thread-pool-ref</span>=<span class="string">"customerThreadPool"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:service</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-预热权重"><a href="#3-预热权重" class="headerlink" title="3. 预热权重"></a>3. 预热权重</h3><p>SOFA-RPC 提供了预热权重功能让客户端机器能够根据服务端的相应权重进行流量的分发。目前支持 bolt 协议。</p>
<p>SOFA-Boot 中提供了一系列参数属性，对指定服务进行预热配置。客户端机器能够自动解析这些参数，并按权重进行流量分发。</p>
<ul>
<li>warm-up-time: 服务的预热时间</li>
<li>warm-up-weight: 服务设置预热期间权重</li>
<li>weight: 服务设置预热完后的权重</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sofa:reference</span> <span class="attr">id</span>=<span class="string">"sampleRestFacadeReferenceBolt"</span> <span class="attr">interface</span>=<span class="string">"com.alipay.sofa.endpoint.facade.SampleFacade"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">sofa:global-attrs</span> <span class="attr">warm-up-time</span>=<span class="string">"10000"</span> <span class="attr">warm-up-weight</span>=<span class="string">"10"</span> <span class="attr">weight</span>=<span class="string">"100"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">sofa:binding.bolt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sofa:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上述配置中，该服务的预热期为10s，在预热期内权重为10，预热期结束后的正常权重为100。</p>
<p>如果该服务一共发布到A，B两个机器上。A机器正处于预热期内，使用上述配置；B已经完成预热，正常权重为200。那么客户端在调用的时候，此时流量分发的比重为10：200；A机器预热结束后，流量分发比重为100：200。</p>
<h2 id="4-自动故障剔除"><a href="#4-自动故障剔除" class="headerlink" title="4. 自动故障剔除"></a>4. 自动故障剔除</h2><p>自动故障剔除会自动监控 RPC 调用的情况，对故障节点进行权重降级，并在节点恢复健康时进行权重恢复。目前支持 bolt 协议。</p>
<p>在 SOFA-Boot 中，只需要将自动故障剔除的参数配置到 <code>application.properties</code> 即可。只配置自己关心的参数，其余参数会取默认值。需要注意的是，<code>rpc.aft.regulation.effective</code> 是该功能的全局开关，如果关闭则该功能不会运行，其他参数也都不生效。</p>
<ul>
<li><strong>自动故障剔除的配置参数意义</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.time.window</td>
<td style="text-align:left">时间窗口大小：对统计信息计算的周期。</td>
<td style="text-align:left">10s</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.least.window.count</td>
<td style="text-align:left">时间窗口内最少调用数：只有在时间窗口内达到了该最低值的数据才会被加入到计算和调控中。</td>
<td style="text-align:left">10次</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.least.window.exception.rate.multiple</td>
<td style="text-align:left">时间窗口内异常率与服务平均异常率的降级比值：在对统计信息进行计算的时候，会计算出该服务所有有效调用ip的平均异常率，如果某个ip的异常率大于等于了这个最低比值，则会被降级。</td>
<td style="text-align:left">6倍</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.weight.degrade.rate</td>
<td style="text-align:left">降级比率：地址在进行权重降级时的降级比率。</td>
<td style="text-align:left">1/20</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.weight.recover.rate</td>
<td style="text-align:left">恢复比率：地址在进行权重恢复时的恢复比率。</td>
<td style="text-align:left">2倍</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.degrade.effective</td>
<td style="text-align:left">降级开关：如果应用打开了这个开关，则会对符合降级的地址进行降级，否则只会进行日志打印。</td>
<td style="text-align:left">false(关闭)</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.degrade.least.weight</td>
<td style="text-align:left">降级最小权重：地址权重被降级后的值如果小于这个最小权重，则会以该最小权重作为降级后的值。</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.degrade.max.ip.count</td>
<td style="text-align:left">降级的最大ip数：同一个服务被降级的ip数不能超过该值。</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">com.alipay.sofa.rpc.aft.regulation.effective</td>
<td style="text-align:left">全局开关：如果应用打开了这个开关，则会开启整个单点故障自动剔除摘除功能，否则完全不进入该功能的逻辑。</td>
<td style="text-align:left">false(关闭)</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>配置示例</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">com.alipay.sofa.rpc.aft.time.window=20</span><br><span class="line">com.alipay.sofa.rpc.aft.least.window.count=30</span><br><span class="line">com.alipay.sofa.rpc.aft.least.window.exception.rate.multiple=6</span><br><span class="line">com.alipay.sofa.rpc.aft.weight.degrade.rate=0.5</span><br><span class="line">com.alipay.sofa.rpc.aft.weight.recover.rate=1.2</span><br><span class="line">com.alipay.sofa.rpc.aft.degrade.effective=ture</span><br><span class="line">com.alipay.sofa.rpc.aft.degrade.least.weight=1</span><br><span class="line">com.alipay.sofa.rpc.aft.degrade.max.ip.count=2</span><br><span class="line">com.alipay.sofa.rpc.aft.regulation.effective=true</span><br></pre></td></tr></table></figure>
<p>上述配置中，默认打开了自动故障剔除功能和降级开关。当节点出现故障时会被进行权重降级，在恢复时会被进行权重恢复。</p>
<p>每隔 20s 进行一次节点健康状态的度量，20s 内调用次数超过 30 次的节点才被作为计算数据。</p>
<p>如果单个节点的异常率超过了所有节点的平均异常率的 6 倍，则对该节点进行权重降级，降级的比率为 0.5。权重最小降级到 1。如果单个节点的异常率低于了平均异常率的 6 倍，则对该节点进行权重恢复，恢复的比率为1.2。单个服务最多降级 2 个 IP。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本文介绍了 <code>SOFA-RPC</code> 的高级功能，包括参数配置，自定义线程池，服务预热和自动降级与权重恢复等用法。对于 <code>SOFA-RPC</code> 提供的基本功能，以及整合 <code>SOFA-Boot</code> 的配置和用法就介绍完了。对此有了初步的认识后，有利于后续深入实现原理和剖析源码。</p>
<hr>
<p>欢迎扫码关注我的个人技术公众号： 零壹技术栈</p>
<p><img src="http://upload-images.jianshu.io/upload_images/10548396-035e78bdc34c7525?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>本帐号将持续分享后端技术干货，包括虚拟机基础，多线程编程，高性能框架，异步、缓存和消息中间件，分布式和微服务，架构学习和进阶等学习资料和文章。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://ostenant.coding.me/2018/05/12/蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)/" data-id="cjhty7pg10067na4udz0bb6xg" class="article-share-link" data-share="baidu" data-title="蚂蚁金服SOFA-Boot整合SOFA-RPC(下篇)">分享到</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RPC/">RPC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SOFA-Boot/">SOFA-Boot</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SOFA-RPC/">SOFA_RPC</a></li></ul>

    </footer>
	
  
    
<nav id="article-nav">
  
    <a href="/2018/05/14/分布式唯一ID的几种生成方案/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          分布式唯一ID的几种生成方案
        
      </div>
    </a>
  
  
    <a href="/2018/05/09/蚂蚁金服SOFA-Boot整合SOFA-RPC(中篇)/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">蚂蚁金服SOFA-Boot整合SOFA-RPC(中篇)</div>
    </a>
  
</nav>

  
</article>








</section>
      
      <aside id="sidebar">
  
    
<div class="widget-wrap">
  <h3 class="widget-title">关于我</h3>
  <ul class="widget about-me">
    
    <li><img class="author" title="About me" src="/img/favicon.png" /></li>
    
    
    <li>ostenant@163.com</li>
    
    <li>一枚热爱生活，追逐自由的小技术！</li>
    
  </ul>
</div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker学习系列/">Docker学习系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ECMAScript基础系列/">ECMAScript基础系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA编程进阶系列/">JAVA编程进阶系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA虚拟机系列/">JAVA虚拟机系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA设计模式系列/">JAVA设计模式系列</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JDK1-8编程系列/">JDK1.8编程系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java编程基础系列/">Java编程基础系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java编程进阶系列/">Java编程进阶系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java虚拟机系列/">Java虚拟机系列</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RPC通信框架系列/">RPC通信框架系列</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RxJava异步框架系列/">RxJava异步框架系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot-2-0系列/">Spring Boot 2.0系列</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot-2-0系列/Spring-Reactive编程系列/">Spring Reactive编程系列</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Reactive编程系列/">Spring Reactive编程系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式系列/">分布式系列</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微服务系列/">微服务系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术知识图谱/">技术知识图谱</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构学习系列/">架构学习系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络协议系列/">网络协议系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/认证与授权系列/">认证与授权系列</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2PC/">2PC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/3PC/">3PC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adapter/">Adapter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/">Apache</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BASE/">BASE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Builder/">Builder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CAP/">CAP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS/">CentOS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul/">Consul</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul-template/">Consul-template</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECMAScript/">ECMAScript</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTPS/">HTTPS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK/">JDK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK1-8/">JDK1.8</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/">NIO</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OAuth-2-0/">OAuth 2.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prototype/">Prototype</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RPC/">RPC</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reactive-Streams/">Reactive Streams</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reactor/">Reactor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reference/">Reference</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Registrator/">Registrator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/">RxJava</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-Boot/">SOFA-Boot</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-RPC/">SOFA-RPC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-RPC/">SOFA_RPC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Singleton/">Singleton</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot-2-0/">Spring Boot 2.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Cloud/">Spring Cloud</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-WebFlux/">Spring WebFlux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thrift/">Thrift</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unique-ID/">Unique ID</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/">Web</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/">WebSocket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/异步/">异步</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/2PC/" style="font-size: 10px;">2PC</a> <a href="/tags/3PC/" style="font-size: 10px;">3PC</a> <a href="/tags/Adapter/" style="font-size: 10px;">Adapter</a> <a href="/tags/Android/" style="font-size: 13.33px;">Android</a> <a href="/tags/Apache/" style="font-size: 13.33px;">Apache</a> <a href="/tags/BASE/" style="font-size: 10px;">BASE</a> <a href="/tags/Builder/" style="font-size: 10px;">Builder</a> <a href="/tags/CAP/" style="font-size: 10px;">CAP</a> <a href="/tags/CentOS/" style="font-size: 10px;">CentOS</a> <a href="/tags/Consul/" style="font-size: 11.67px;">Consul</a> <a href="/tags/Consul-template/" style="font-size: 10px;">Consul-template</a> <a href="/tags/Docker/" style="font-size: 13.33px;">Docker</a> <a href="/tags/ECMAScript/" style="font-size: 11.67px;">ECMAScript</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/JDK/" style="font-size: 10px;">JDK</a> <a href="/tags/JDK1-8/" style="font-size: 11.67px;">JDK1.8</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/Java/" style="font-size: 18.33px;">Java</a> <a href="/tags/NIO/" style="font-size: 15px;">NIO</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/OAuth-2-0/" style="font-size: 10px;">OAuth 2.0</a> <a href="/tags/Prototype/" style="font-size: 10px;">Prototype</a> <a href="/tags/RPC/" style="font-size: 20px;">RPC</a> <a href="/tags/Reactive-Streams/" style="font-size: 11.67px;">Reactive Streams</a> <a href="/tags/Reactor/" style="font-size: 10px;">Reactor</a> <a href="/tags/Reference/" style="font-size: 10px;">Reference</a> <a href="/tags/Registrator/" style="font-size: 10px;">Registrator</a> <a href="/tags/RxJava/" style="font-size: 13.33px;">RxJava</a> <a href="/tags/SOFA-Boot/" style="font-size: 13.33px;">SOFA-Boot</a> <a href="/tags/SOFA-RPC/" style="font-size: 11.67px;">SOFA-RPC</a> <a href="/tags/SOFA-RPC/" style="font-size: 11.67px;">SOFA_RPC</a> <a href="/tags/Singleton/" style="font-size: 10px;">Singleton</a> <a href="/tags/Spring-Boot-2-0/" style="font-size: 10px;">Spring Boot 2.0</a> <a href="/tags/Spring-Cloud/" style="font-size: 11.67px;">Spring Cloud</a> <a href="/tags/Spring-WebFlux/" style="font-size: 11.67px;">Spring WebFlux</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/Thrift/" style="font-size: 16.67px;">Thrift</a> <a href="/tags/Unique-ID/" style="font-size: 10px;">Unique ID</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/分布式/" style="font-size: 15px;">分布式</a> <a href="/tags/异步/" style="font-size: 13.33px;">异步</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/30/2018服务端架构师技术图谱/">2018服务端架构师技术图谱</a>
          </li>
        
          <li>
            <a href="/2018/05/27/实战Spring Boot 2.0 Reactive编程系列(一) - WebFlux初体验/">实战Spring Boot 2.0 Reactive编程系列(一) - WebFlux初体验</a>
          </li>
        
          <li>
            <a href="/2018/05/26/聊聊Spring Reactor反应式编程/">聊聊Spring Reactor反应式编程</a>
          </li>
        
          <li>
            <a href="/2018/05/23/Android异步框架RxJava 1.x系列(三) - 线程调度器Scheduler/">Android异步框架RxJava 1.x系列(三) - 线程调度器Scheduler</a>
          </li>
        
          <li>
            <a href="/2018/05/21/Android异步框架RxJava 1.x系列(二) - 事件及事件序列转换原理/">Android异步框架RxJava 1.x系列(二) - 事件及事件序列转换原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://weekly.manong.io/issues" target="_blank">码农周刊</a>
          </li>
        
          <li>
            <a href="https://www.tuicool.com/mags" target="_blank">编程狂人</a>
          </li>
        
          <li>
            <a href="http://ifeve.com" target="_blank">并发编程网</a>
          </li>
        
          <li>
            <a href="https://juejin.im" target="_blank">掘金</a>
          </li>
        
          <li>
            <a href="http://www.jianshu.com" target="_blank">简书</a>
          </li>
        
          <li>
            <a href="https://github.com" target="_blank">Github</a>
          </li>
        
          <li>
            <a href="https://stackoverflow.com" target="_blank">StackoverFlow</a>
          </li>
        
          <li>
            <a href="http://www.infoq.com" target="_blank">Infoq</a>
          </li>
        
          <li>
            <a href="https://segmentfault.com" target="_blank">SegmentFault</a>
          </li>
        
          <li>
            <a href="http://www.importnew.com" target="_blank">ImportNew</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Chen Harrison<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="https://github.com/ostenant" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!--

-->



   

<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>



<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true
                    
}
  
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                  
}
    
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                            all[i].SourceElement().parentNode.className += ' has-jax';
                                    
            }
                
        });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<script src="/js/script.js"></script>


</div>
</body>
</html>
