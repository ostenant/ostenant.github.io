<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>JVM系列(二) - JVM内存区域和内存溢出异常详解 | Harrison&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="前言JVM内存区域包括PC计数器、Java虚拟机栈、本地方法栈、堆、方法区、运行时常量池和直接内存。 本文主要介绍各个内存区域的作用和特性，同时分别阐述各个区域发生内存溢出的可能性和异常类型。">
<meta name="keywords" content="JVM,Java">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM系列(二) - JVM内存区域和内存溢出异常详解">
<meta property="og:url" content="https://ostenant.coding.me/2017/04/25/JVM系列(二) - JVM内存区域和内存溢出异常详解/index.html">
<meta property="og:site_name" content="Harrison&#39;s Blog">
<meta property="og:description" content="前言JVM内存区域包括PC计数器、Java虚拟机栈、本地方法栈、堆、方法区、运行时常量池和直接内存。 本文主要介绍各个内存区域的作用和特性，同时分别阐述各个区域发生内存溢出的可能性和异常类型。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/image/png/运行时内存区域%28一%29.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/image/png/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F%28%E4%BA%8C%29.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/image/jpg/operand_stack1.jpg">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/image/png/HeapOOM.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/HeapOOMDump2.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/HeapOOM_HeapDump_01.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/JavaVMStackSOF.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/JavaVMStackSOF_Result%20.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/RuntimeConstantPoolOOM.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/DirectMemoryOOM.png">
<meta property="og:image" content="http://ols3fdyll.bkt.clouddn.com/DirectMemoryOOM_Result.png">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/10548396-035e78bdc34c7525?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-05-08T02:49:46.090Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JVM系列(二) - JVM内存区域和内存溢出异常详解">
<meta name="twitter:description" content="前言JVM内存区域包括PC计数器、Java虚拟机栈、本地方法栈、堆、方法区、运行时常量池和直接内存。 本文主要介绍各个内存区域的作用和特性，同时分别阐述各个区域发生内存溢出的可能性和异常类型。">
<meta name="twitter:image" content="http://ols3fdyll.bkt.clouddn.com/image/png/运行时内存区域%28一%29.png">
    

    
        <link rel="alternate" href="/" title="Harrison&#39;s Blog" type="application/atom+xml" />
    

    
        <link rel="icon" href="/css/images/favicon.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome5/css/fontawesome.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-brands.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-solid.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'true', 'auto');
ga('send', 'pageview');

</script>
    
    
        <meta name="google-site-verification" content="true" />
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Harrison&#39;s Blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">主页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于我</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.jpeg" />
                            <i class="fas fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fas fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">主页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于我</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile" class="profile-fixed">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.jpeg" />
            <h2 id="name">陈林 | Harrison</h2>
            <h3 id="title">年轻无为，卖码为生。</h3>
            <span id="location"><i class="fas fa-map-marker-alt" style="padding-right: 5px"></i>中国, 成都</span>
            <a id="follow" target="_blank" href="http://github.com/ostenant">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                50
                <span>文章</span>
            </div>
            <div class="article-info-block">
                46
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/ostenant" target="_blank" title="github" class=tooltip>
                            <i class="fab fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fab fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fab fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fab fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="linkedin" class=tooltip>
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fab fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-JVM系列(二) - JVM内存区域和内存溢出异常详解" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            JVM系列(二) - JVM内存区域和内存溢出异常详解
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2017/04/25/JVM系列(二) - JVM内存区域和内存溢出异常详解/">
            <time datetime="2017-04-25T09:57:00.000Z" itemprop="datePublished">2017-04-25</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fas fa-folder"></i>
        <a class="article-category-link" href="/categories/Java虚拟机系列/">Java虚拟机系列</a>
    </div>

                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/JVM/">JVM</a>, <a class="tag-link" href="/tags/Java/">Java</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <hr>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><code>JVM</code>内存区域包括<strong>PC计数器</strong>、<strong>Java虚拟机栈</strong>、<strong>本地方法栈</strong>、<strong>堆</strong>、<strong>方法区</strong>、<strong>运行时常量池</strong>和<strong>直接内存</strong>。</p>
<p>本文主要介绍各个内存区域的作用和特性，同时分别阐述各个区域发生内存溢出的可能性和异常类型。</p>
<a id="more"></a>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><hr>
<h2 id="一-JVM内存区域"><a href="#一-JVM内存区域" class="headerlink" title="(一). JVM内存区域"></a>(一). JVM内存区域</h2><p><code>Java</code>虚拟机执行<code>Java</code>程序的过程中，会把所管理的内存划分为若干不同的<strong>数据区域</strong>。这些内存区域各有各的用途，以及创建和销毁时间。有的区域随着虚拟机进程的启动而存在，有的区域伴随着用户线程的启动和结束而创建和销毁。</p>
<p><code>JVM</code><strong>内存区域</strong>也称为<code>Java</code><strong>运行时数据区域</strong>。其中包括：<strong>程序计数器</strong>、<strong>虚拟机栈</strong>、<strong>本地方法栈</strong>、<strong>堆</strong>、<strong>静态方法区</strong>、<strong>静态常量池</strong>等。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/image/png/运行时内存区域%28一%29.png" alt=""></p>
<blockquote>
<p>注意：程序计数器、虚拟机栈、本地方法栈属于每个<strong>线程私有的</strong>；堆和方法区属于<strong>线程共享访问的</strong>。</p>
</blockquote>
<p><img src="http://ols3fdyll.bkt.clouddn.com/image/png/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F%28%E4%BA%8C%29.png" alt=""></p>
<h3 id="1-1-PC计数器"><a href="#1-1-PC计数器" class="headerlink" title="1.1. PC计数器"></a>1.1. PC计数器</h3><p>程序计数器（<code>Program Counter Register</code>）是一块<strong>较小</strong>的内存空间，它的作用可以看做是<strong>当前线程</strong>所执行的<strong>字节码行号指示器</strong>。</p>
<ol>
<li>当前线程所执行的字节码<strong>行号指示器</strong>。</li>
<li>每个线程都有一个自己的<code>PC</code>计数器。</li>
<li>线程<strong>私有的</strong>，生命周期与线程相同，随<code>JVM</code>启动而生，<code>JVM</code>关闭而死。</li>
<li>线程执行<code>Java</code>方法时，记录其正在执行的虚拟机<strong>字节码指令地址</strong>。</li>
<li>线程执行<code>Native</code>方法时，计数器记录为<strong>空</strong>(<code>Undefined</code>)。</li>
<li>唯一在<code>Java</code>虚拟机规范中没有规定任何<code>OutOfMemoryError</code>情况区域。</li>
</ol>
<h3 id="1-2-Java虚拟机栈"><a href="#1-2-Java虚拟机栈" class="headerlink" title="1.2. Java虚拟机栈"></a>1.2. Java虚拟机栈</h3><p>线程<strong>私有</strong>内存空间，它的生命周期和线程相同。线程执行期间，每个方法执行时都会创建一个<strong>栈帧(Stack Frame)</strong> ，用于存储 <strong>局部变量表</strong>、<strong>操作数栈</strong> 、<strong>动态链接</strong> 、<strong>方法出口</strong> 等信息。</p>
<ol>
<li><strong>局部变量表</strong></li>
<li><strong>操作数栈</strong></li>
<li><strong>动态链接</strong></li>
<li><strong>方法出口</strong></li>
</ol>
<blockquote>
<p>每一个方法从调用直到执行完成的过程，就对应着一个<strong>栈帧</strong>在虚拟机栈中的<strong>入栈</strong>和<strong>出栈</strong>的全过程。</p>
</blockquote>
<p>下面依次解释<strong>栈帧</strong>里的四种组成元素的具体结构和功能：</p>
<h4 id="1-局部变量表"><a href="#1-局部变量表" class="headerlink" title="1). 局部变量表"></a>1). 局部变量表</h4><p><strong>局部变量表</strong>是一组<strong>变量值</strong>的存储空间，用于存储<strong>方法参数</strong>和<strong>局部变量</strong>。 在 <code>Class</code> 文件的方法表的 <code>Code</code> 属性的 <code>max_locals</code> 指定了该方法所需局部变量表的<strong>最大容量</strong>。</p>
<p><strong>局部变量表</strong>在编译期间分配内存空间，可以存放<strong>编译期</strong>的各种变量类型：</p>
<ol>
<li><strong>基本数据类型</strong> ：<code>boolean</code>, <code>byte</code>, <code>char</code>, <code>short</code>, <code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>等<code>8</code>种；</li>
<li><strong>对象引用类型</strong> ：<code>reference</code>，指向对象<strong>起始地址</strong>的<strong>引用指针</strong>；</li>
<li><strong>返回地址类型</strong> ：<code>returnAddress</code>，返回地址的类型。</li>
</ol>
<p>变量槽(<code>Variable Slot</code>)：</p>
<blockquote>
<p><strong>变量槽</strong>是<strong>局部变量表</strong>的<strong>最小单位</strong>，规定大小为<code>32</code>位。对于<code>64</code>位的<code>long</code>和<code>double</code>变量而言，虚拟机会为其分配<strong>两个连续</strong>的<code>Slot</code>空间。</p>
</blockquote>
<h4 id="2-操作数栈"><a href="#2-操作数栈" class="headerlink" title="2). 操作数栈"></a>2). 操作数栈</h4><p><strong>操作数栈</strong>（<code>Operand Stack</code>）也常称为操作栈，是一个后入先出栈。在 <code>Class</code> 文件的 <code>Code</code> 属性的 <code>max_stacks</code> 指定了执行过程中最大的栈深度。<code>Java</code>虚拟机的<strong>解释执行引擎</strong>被称为<strong>基于栈的执行引擎</strong> ，其中所指的<strong>栈</strong>就是指－<strong>操作数栈</strong>。</p>
<ol>
<li>和<strong>局部变量表</strong>一样，<strong>操作数栈</strong>也是一个以<code>32</code><strong>字长</strong>为单位的数组。</li>
<li>虚拟机在操作数栈中可存储的<strong>数据类型</strong>：<code>int</code>、<code>long</code>、<code>float</code>、<code>double</code>、<code>reference</code>和<code>returnType</code>等类型 (对于<code>byte</code>、<code>short</code>以及<code>char</code>类型的值在压入到操作数栈之前，也会被转换为<code>int</code>)。</li>
<li>和<strong>局部变量表</strong>不同的是，它不是通过<strong>索引</strong>来访问，而是通过标准的<strong>栈操作</strong> — <strong>压栈</strong>和<strong>出栈</strong>来访问。比如，如果某个指令把一个值压入到操作数栈中，稍后另一个指令就可以弹出这个值来使用。</li>
</ol>
<p><strong>虚拟机把操作数栈作为它的工作区——大多数指令都要从这里弹出数据，执行运算，然后把结果压回操作数栈</strong>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">iload_0    <span class="comment">// push the int in local variable 0 onto the stack</span></span><br><span class="line">iload_1    <span class="comment">// push the int in local variable 1 onto the stack</span></span><br><span class="line">iadd       <span class="comment">// pop two ints, add them, push result</span></span><br><span class="line">istore_2   <span class="comment">// pop int, store into local variable 2</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在这个<strong>字节码序列</strong>里，前两个指令 <code>iload_0</code> 和 <code>iload_1</code> 将存储在<strong>局部变量表</strong>中索引为<code>0</code>和<code>1</code>的整数压入操作数栈中，其后<code>iadd</code>指令从操作数栈中弹出那两个整数相加，再将结果压入<strong>操作数栈</strong>。第四条指令<code>istore_2</code>则从<strong>操作数栈</strong>中弹出结果，并把它存储到<strong>局部变量表</strong>索引为<code>2</code>的位置。</p>
</blockquote>
<p>下图详细表述了这个过程中<strong>局部变量表</strong>和<strong>操作数栈</strong>的状态变化(图中没有使用的<strong>局部变量表</strong>和<strong>操作数栈</strong>区域以空白表示)。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/image/jpg/operand_stack1.jpg" alt=""></p>
<h4 id="3-动态链接"><a href="#3-动态链接" class="headerlink" title="3). 动态链接"></a>3). 动态链接</h4><p>每个<strong>栈帧</strong>都包含一个指向运行时<strong>常量池</strong>中所属的<strong>方法引用</strong>，持有这个引用是为了支持方法调用过程中的<strong>动态链接</strong>。</p>
<p><code>Class</code>文件的<strong>常量池</strong>中存在有大量的<strong>符号引用</strong>，字节码中的<strong>方法调用指令</strong>就以常量池中指向方法的<strong>符号引用</strong>为参数。这些符号引用：</p>
<ol>
<li>静态解析：一部分会在<strong>类加载阶段</strong>或第一次使用的时候转化为<strong>直接引用</strong>（如<code>final</code>、<code>static</code>域等），称为<strong>静态解析</strong>，</li>
<li>动态解析：另一部分将在每一次的<strong>运行期间</strong>转化为<strong>直接引用</strong>，称为<strong>动态链接</strong>。</li>
</ol>
<h5 id="4-方法返回地址"><a href="#4-方法返回地址" class="headerlink" title="4). 方法返回地址"></a>4). 方法返回地址</h5><p>当一个方法开始执行以后，只有两种方法可以退出当前方法：</p>
<ol>
<li><strong>正常返回</strong>：当执行遇到返回指令，会将返回值传递给上层的方法调用者，这种退出的方式称为<strong>正常完成出口</strong>(<code>Normal Method Invocation Completion</code>)，一般来说，调用者的<code>PC</code><strong>计数器</strong>可以作为返回地址。</li>
<li><strong>异常返回</strong>：当执行遇到异常，并且当前方法体内没有得到处理，就会导致方法退出，此时是没有返回值的，称为<strong>异常完成出口</strong>(<code>Abrupt Method Invocation Completion</code>)，返回地址要通过<strong>异常处理器</strong>表来确定。</li>
</ol>
<p>当一个方法返回时，可能依次进行以下<code>3</code>个操作：</p>
<ol>
<li>恢复<strong>上层方法</strong>的<strong>局部变量表</strong>和<strong>操作数栈</strong>。</li>
<li>把<strong>返回值</strong>压入<strong>调用者栈帧</strong>的<strong>操作数栈</strong>。</li>
<li>将<code>PC</code><strong>计数器</strong>的值指向<strong>下一条</strong>方法指令位置。</li>
</ol>
<p><strong>小结：</strong></p>
<blockquote>
<p><strong>注意</strong>：在Java虚拟机规范中，对这个区域规定了两种异常。<br><strong>其一</strong>：如果当前线程请求的栈深度大于虚拟机栈所允许的深度，将会抛出 <code>StackOverflowError</code> 异常（在虚拟机栈不允许动态扩展的情况下）；<strong>其二</strong>：如果扩展时无法申请到足够的内存空间，就会抛出 <code>OutOfMemoryError</code> 异常。</p>
</blockquote>
<h3 id="1-3-本地方法栈"><a href="#1-3-本地方法栈" class="headerlink" title="1.3. 本地方法栈"></a>1.3. 本地方法栈</h3><p><strong>本地方法栈</strong>和<code>Java</code><strong>虚拟机栈</strong>发挥的作用非常相似，主要区别是<code>Java</code><strong>虚拟机栈</strong>执行的是<code>Java</code><strong>方法服务</strong>，而<strong>本地方法栈</strong>执行<code>Native</code><strong>方法服务</strong>(通常用C编写)。</p>
<blockquote>
<p>有些虚拟机发行版本(譬如<code>Sun HotSpot</code>虚拟机)直接将<strong>本地方法栈</strong>和<code>Java</code><strong>虚拟机</strong>栈合二为一。与虚拟机栈一样，本地方法栈也会抛出<code>StackOverflowError</code>和<code>OutOfMemoryError</code>异常。</p>
</blockquote>
<h3 id="1-4-堆"><a href="#1-4-堆" class="headerlink" title="1.4. 堆"></a>1.4. 堆</h3><p><code>Java</code>堆是被所有<strong>线程共享</strong>的<strong>最大</strong>的一块内存区域，在虚拟机启动时创建。此内存区域的唯一目的就是<strong>存放对象实例</strong>，几乎所有的对象实例都在这里分配内存。</p>
<p>在<code>Java</code>中，堆被划分成两个不同的区域：<strong>新生代</strong> (<code>Young Generation</code>) 、<strong>老年代</strong> (<code>Old Generation</code>) 。<strong>新生代</strong> (<code>Young</code>) 又被划分为三个区域：<strong>一个</strong><code>Eden</code>区和<strong>两个</strong><code>Survivor</code>区 - <code>From Survivor</code>区和<code>To Survivor</code>区。</p>
<blockquote>
<p>简要归纳：新的对象分配是首先放在年轻代 (<code>Young Generation</code>) 的<code>Eden</code>区，<code>Survivor</code>区作为<code>Eden</code>区和<code>Old</code>区的缓冲，在<code>Survivor</code>区的对象经历若干次收集仍然存活的，就会被转移到老年代<code>Old</code>中。</p>
</blockquote>
<p>这样划分的目的是为了使<code>JVM</code>能够更好的管理堆内存中的对象，包括内存的分配以及回收。</p>
<h3 id="1-5-方法区"><a href="#1-5-方法区" class="headerlink" title="1.5. 方法区"></a>1.5. 方法区</h3><p>方法区和<code>Java</code>堆一样，为多个线程共享，它用于存储<strong>类信息</strong>、<strong>常量</strong>、<strong>静态常量</strong>和<strong>即时编译后的代码</strong>等数据。</p>
<h3 id="1-6-运行时常量池"><a href="#1-6-运行时常量池" class="headerlink" title="1.6. 运行时常量池"></a>1.6. 运行时常量池</h3><p>运行时常量池是<strong>方法区</strong>的一部分，<code>Class</code>文件中除了有<strong>类的版本</strong>、<strong>字段</strong>、<strong>方法</strong>和<strong>接口</strong>等描述信息外，<br>还有一类信息是<strong>常量池</strong>，用于存储编译期间生成的各种<strong>字面量</strong>和<strong>符号引用</strong>。</p>
<h3 id="1-7-直接内存"><a href="#1-7-直接内存" class="headerlink" title="1.7. 直接内存"></a>1.7. 直接内存</h3><p><strong>直接内存</strong>不属于虚拟机运行时数据区的一部分，也不是<code>Java</code>虚拟机规范中定义的内存区域。<br><code>Java NIO</code>允许<code>Java</code>程序直接访问<strong>直接内存</strong>，通常<strong>直接内存</strong>的速度会优于<strong>Java堆内存</strong>。因此，对于读写频繁、性能要求高的场景，可以考虑使用直接内存。</p>
<h2 id="二-常见内存溢出异常"><a href="#二-常见内存溢出异常" class="headerlink" title="(二). 常见内存溢出异常"></a>(二). 常见内存溢出异常</h2><p>除了程序计数器外，<code>Java</code>虚拟机的其他运行时区域都有可能发生<code>OutOfMemoryError</code>的异常，下面分别给出验证：</p>
<h3 id="2-1-Java堆溢出"><a href="#2-1-Java堆溢出" class="headerlink" title="2.1. Java堆溢出"></a>2.1. Java堆溢出</h3><p><code>Java</code>堆能够存储对象实例。通过不断地创建对象，并保证<code>GC Roots</code>到对象有可达路径来避免垃圾回收机制清除这些对象。<br>当对象数量到达最大堆的容量限制时就会产生<code>OutOfMemoryError</code>异常。</p>
<p>设置<code>JVM</code>启动参数：<code>-Xms20M</code>设置堆的<strong>最小内存</strong>为<code>20M</code>，<code>-Xmx20M</code>设置堆的<strong>最大内存</strong>和<strong>最小内存</strong>一样，这样可以防止<code>Java</code>堆在内存不足时<strong>自动扩容</strong>。<br><code>-XX:+HeapDumpOnOutOfMemoryError</code>参数可以让虚拟机在出现内存溢出异常时<code>Dump</code>出<strong>内存堆</strong>运行时快照。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/image/png/HeapOOM.png" alt=""></p>
<p>HeapOOM.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -Xms20M -Xmx20M -XX:+HeapDumpOnOutOfMemoryError</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapOOM</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">OOMObject</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;OOMObject&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            list.add(<span class="keyword">new</span> OOMObject());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试运行结果：</strong><br><img src="http://ols3fdyll.bkt.clouddn.com/HeapOOMDump2.png" alt=""></p>
<p>打开<code>Java VisualVM</code>导出<code>Heap</code>内存运行时的<code>dump</code>文件。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/HeapOOM_HeapDump_01.png" alt=""><br><code>HeapOOM</code>对象不停地被创建，堆内存使用达到<code>99%</code>。<strong>垃圾回收器</strong>不断地尝试回收但都以失败告终。</p>
<p>分析：遇到这种情况，通常要考虑<strong>内存泄露</strong>和<strong>内存溢出</strong>两种可能性。</p>
<ul>
<li><p>如果是内存泄露：</p>
<blockquote>
<p>进一步使用<code>Java VisualVM</code>工具进行分析，查看<strong>泄露对象</strong>是通过怎样的<code>路径</code>与<code>GC Roots</code>关联而导致<strong>垃圾回收器</strong>无法回收的。</p>
</blockquote>
</li>
<li><p>如果是内存溢出：</p>
<blockquote>
<p>通过<code>Java VisualVM</code>工具分析，不存在泄露对象，也就是说<strong>堆内存</strong>中的对象必须得存活着。就要考虑如下措施：</p>
<ol>
<li>从代码上检查是否存在某些对象<strong>生命周期过长</strong>、<strong>持续状态时间过长</strong>的情况，尝试减少程序运行期的内存。</li>
<li>检查虚拟机的<strong>堆参数</strong>(<code>-Xmx</code>与<code>-Xms</code>)，对比机器的<strong>物理内存</strong>看是否还可以调大。</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="2-2-虚拟机和本地方法栈溢出"><a href="#2-2-虚拟机和本地方法栈溢出" class="headerlink" title="2.2. 虚拟机和本地方法栈溢出"></a>2.2. 虚拟机和本地方法栈溢出</h3><p>关于虚拟机栈和本地方法栈，分析内存异常类型可能存在以下两种：</p>
<ul>
<li>如果现场请求的<strong>栈深度</strong>大于虚拟机所允许的<strong>最大深度</strong>，将抛出<code>StackOverflowError</code>异常。</li>
<li>如果虚拟机在<strong>扩展栈</strong>时无法申请到足够的<strong>内存</strong>空间，可能会抛出<code>OutOfMemoryError</code>异常。</li>
</ul>
<p>可以划分为两类问题，当栈空间无法分配时，到底时栈内存<strong>太小</strong>，还是<strong>已使用</strong>的栈内存<strong>过大</strong>。</p>
<h4 id="StackOverflowError异常"><a href="#StackOverflowError异常" class="headerlink" title="StackOverflowError异常"></a>StackOverflowError异常</h4><p><strong>测试方案一：</strong></p>
<ul>
<li>使用<code>-Xss</code>参数减少<strong>栈内存</strong>的容量，异常发生时打印<strong>栈</strong>的深度。</li>
<li>定义大量的<strong>本地局部变量</strong>，以达到增大<strong>栈帧</strong>中的<strong>本地变量表</strong>的长度。</li>
</ul>
<p>设置<code>JVM</code>启动参数：<code>-Xss128k</code>设置<strong>栈内存</strong>的大小为<code>128k</code>。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/JavaVMStackSOF.png" alt=""></p>
<p>JavaVMStackSOF.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -Xss128k</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaVMStackSOF</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> stackLength = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stackLeak</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        stackLength++;</span><br><span class="line">        stackLeak();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JavaVMStackSOF oom = <span class="keyword">new</span> JavaVMStackSOF();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            oom.stackLeak();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Stack length: "</span> + oom.stackLength);</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试结果：</strong></p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/JavaVMStackSOF_Result%20.png" alt=""></p>
<blockquote>
<p>分析：在单个线程下，无论是<strong>栈帧太大</strong>还是<strong>虚拟机栈容量太小</strong>，当无法分配内存的时候，虚拟机抛出的都是<code>StackOverflowError</code>异常。</p>
</blockquote>
<p><strong>测试方案二：</strong></p>
<ul>
<li>不停地创建<strong>线程</strong>并保持线程运行状态。</li>
</ul>
<p>JavaVMStackOOM.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -Xss2M</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaVMStackOOM</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">running</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stackLeakByThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    running();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JavaVMStackOOM oom = <span class="keyword">new</span> JavaVMStackOOM();</span><br><span class="line">        oom.stackLeakByThread();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试结果：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.OutOfMemoryError: unable to create new native thread</span><br></pre></td></tr></table></figure></p>
<p>上述测试代码运行时存在较大的风险，可能会导致操作系统假死，这里就不亲自测试了，引用作者的测试结果。</p>
<h3 id="2-3-方法区和运行时常量池溢出"><a href="#2-3-方法区和运行时常量池溢出" class="headerlink" title="2.3. 方法区和运行时常量池溢出"></a>2.3. 方法区和运行时常量池溢出</h3><h4 id="一-运行时常量池内存溢出测试"><a href="#一-运行时常量池内存溢出测试" class="headerlink" title="(一). 运行时常量池内存溢出测试"></a>(一). 运行时常量池内存溢出测试</h4><p><strong>运行时常量</strong>和<strong>字面量</strong>都存放于<strong>运行时常量池</strong>中，常量池又是方法区的一部分，因此两个区域的测试是一样的。<br>这里采用<code>String.intern()</code>进行测试：</p>
<blockquote>
<p>String.intern()是一个native方法，它的作用是：如果字符串常量池中存在一个String对象的字符串，那么直接返回常量池中的这个String对象；<br>否则，将此String对象包含的字符串放入常量池中，并且返回这个String对象的引用。</p>
</blockquote>
<p>设置<code>JVM</code>启动参数：通过<code>-XX:PermSize=10M</code>和<code>-XX:MaxPermSize=10M</code>限制<strong>方法区</strong>的大小为<code>10M</code>，从而间接的限制其中<strong>常量池</strong>的容量。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/RuntimeConstantPoolOOM.png" alt=""></p>
<p>RuntimeConstantPoolOOM.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -XX:PermSize=10M -XX:MaxPermSize=10M</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RuntimeConstantPoolOOM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 使用List保持着常量池的引用，避免Full GC回收常量池</span></span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 10MB的PermSize在Integer范围内足够产生OOM了</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            list.add(String.valueOf(i++).intern());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试结果分析：</strong></p>
<p><code>JDK1.6</code>版本运行结果：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.OutOfMemoryError: PermGen space</span><br><span class="line">    at java.lang.String.intern(Native Method)</span><br></pre></td></tr></table></figure></p>
<p><code>JDK1.6</code>版本运行结果显示<strong>常量池</strong>会溢出并抛出<strong>永久带</strong>的<code>OutOfMemoryError</code>异常。<br>而<code>JDK1.7</code>及以上的版本则不会得到相同的结果，它会一直循环下去。</p>
<h5 id="二-方法区内存溢出测试"><a href="#二-方法区内存溢出测试" class="headerlink" title="(二). 方法区内存溢出测试"></a>(二). 方法区内存溢出测试</h5><p>方法区存放<code>Class</code>相关的信息，比如<strong>类名</strong>、<strong>访问修饰符</strong>、<strong>常量池</strong>、<strong>字段描述</strong>、<strong>方法描述</strong>等。<br>对于<strong>方法区的内存溢出</strong>的测试，基本思路是在运行时产生大量<strong>类字节码</strong>区填充<strong>方法区</strong>。</p>
<p>这里引入<code>Spring</code>框架的<code>CGLib</code>动态代理的<strong>字节码技术</strong>，通过循环不断生成新的<strong>代理类</strong>，达到<strong>方法区</strong>内存溢出的效果。</p>
<p>JavaMethodAreaOOM.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -XX:PermSize=10M -XX:MaxPermSize=10M</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaMethodAreaOOM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">            enhancer.setSuperclass(OOMObject.class);</span><br><span class="line">            enhancer.setUseCache(<span class="keyword">false</span>);</span><br><span class="line">            enhancer.setCallback(<span class="keyword">new</span> MethodInterceptor() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> proxy.invokeSuper(obj, args);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            enhancer.create();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">OOMObject</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">OOMObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>JDK1.6</code>版本运行结果：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.OutOfMemoryError: PermGen space</span><br><span class="line">    at java.lang.ClassLoader.defineClass1(Native Method)</span><br><span class="line">    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)</span><br><span class="line">    at java.lang.ClassLoader.defineClass(ClassLoader.java:616)</span><br></pre></td></tr></table></figure></p>
<p>测试结果分析：</p>
<p><code>JDK1.6</code>版本运行结果显示<strong>常量池</strong>会溢出并抛出<strong>永久带</strong>的<code>OutOfMemoryError</code>异常。<br>而<code>JDK1.7</code>及以上的版本则不会得到相同的结果，它会一直循环下去。</p>
<h3 id="2-4-直接内存溢出"><a href="#2-4-直接内存溢出" class="headerlink" title="2.4. 直接内存溢出"></a>2.4. 直接内存溢出</h3><p>本机<strong>直接内存</strong>的容量可通过<code>-XX:MaxDirectMemorySize</code>指定，如果不指定，则默认与<code>Java</code>堆<strong>最大值</strong>(-Xmx指定)一样。</p>
<p><strong>测试场景：</strong></p>
<p>直接通过反射获取<code>Unsafe</code>实例，通过反射向操作系统申请分配内存：</p>
<p>设置<code>JVM</code>启动参数：<code>-Xmx20M</code>指定<code>Java</code>堆的最大内存，<code>-XX:MaxDirectMemorySize=10M</code>指定<strong>直接内存</strong>的大小。</p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/DirectMemoryOOM.png" alt=""></p>
<p>DirectMemoryOOM.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * VM Args: -Xmx20M -XX:MaxDirectMemorySize=10M</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DirectMemoryOOM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> _1MB = <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Field unsafeField = Unsafe.class.getDeclaredFields()[<span class="number">0</span>];</span><br><span class="line">        unsafeField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        Unsafe unsafe = (Unsafe) unsafeField.get(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            unsafe.allocateMemory(_1MB);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试结果：</strong></p>
<p><img src="http://ols3fdyll.bkt.clouddn.com/DirectMemoryOOM_Result.png" alt=""></p>
<p><strong>测试结果分析：</strong></p>
<p>由<code>DirectMemory</code>导致的内存溢出，一个明显的特征是<code>Heap Dump</code>文件中不会看到明显的异常信息。<br>如果<code>OOM</code>发生后<code>Dump</code>文件很小，并且程序中直接或者间接地使用了<code>NIO</code>，那么就可以考虑一下这方面的问题。</p>
<hr>
<p>欢迎扫码关注我的个人技术公众号： 零壹技术栈</p>
<p><img src="http://upload-images.jianshu.io/upload_images/10548396-035e78bdc34c7525?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>本帐号将持续分享后端技术干货，包括虚拟机基础，多线程编程，高性能框架，异步、缓存和消息中间件，分布式和微服务，架构学习和进阶等学习资料和文章。</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>

</div>

            
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/04/28/JVM系列(三) - JVM对象探秘/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">上一篇</strong>
            <div class="article-nav-title">
                
                    JVM系列(三) - JVM对象探秘
                
            </div>
        </a>
    
    
        <a href="/2017/04/22/JVM系列(一) - JVM总体概述/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">JVM系列(一) - JVM总体概述</div>
        </a>
    
</nav>


    
</article>


    
    

</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="no-thumbnail">
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/分布式系列/">分布式系列</a></p>
                            <p class="item-title"><a href="/2018/06/05/分布式理论(六) - 一致性协议Raft/" class="title">分布式理论(六) - 一致性协议Raft</a></p>
                            <p class="item-date"><time datetime="2018-06-05T13:20:00.000Z" itemprop="datePublished">2018-06-05</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/分布式系列/">分布式系列</a></p>
                            <p class="item-title"><a href="/2018/06/03/分布式理论(五) - 一致性算法Paxos/" class="title">分布式理论(五) - 一致性算法Paxos</a></p>
                            <p class="item-date"><time datetime="2018-06-03T13:30:00.000Z" itemprop="datePublished">2018-06-03</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/测试框架系列/">测试框架系列</a></p>
                            <p class="item-title"><a href="/2018/05/31/单元测试利器Mockito框架/" class="title">单元测试利器Mockito框架</a></p>
                            <p class="item-date"><time datetime="2018-05-31T15:30:00.000Z" itemprop="datePublished">2018-05-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术知识图谱/">技术知识图谱</a></p>
                            <p class="item-title"><a href="/2018/05/30/2018服务端架构师技术图谱/" class="title">2018服务端架构师技术图谱</a></p>
                            <p class="item-date"><time datetime="2018-05-30T14:46:00.000Z" itemprop="datePublished">2018-05-30</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Spring-Reactive编程系列/">Spring Reactive编程系列</a></p>
                            <p class="item-title"><a href="/2018/05/27/实战Spring Boot 2.0 Reactive编程系列(一) - WebFlux初体验/" class="title">实战Spring Boot 2.0 Reactive编程系列(一) - WebFlux初体验</a></p>
                            <p class="item-date"><time datetime="2018-05-27T07:25:00.000Z" itemprop="datePublished">2018-05-27</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker学习系列/">Docker学习系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ECMAScript基础系列/">ECMAScript基础系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA编程进阶系列/">JAVA编程进阶系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA虚拟机系列/">JAVA虚拟机系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA设计模式系列/">JAVA设计模式系列</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JDK1-8编程系列/">JDK1.8编程系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java编程基础系列/">Java编程基础系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java编程进阶系列/">Java编程进阶系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java虚拟机系列/">Java虚拟机系列</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RPC通信框架系列/">RPC通信框架系列</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RxJava异步框架系列/">RxJava异步框架系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Reactive编程系列/">Spring Reactive编程系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式系列/">分布式系列</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微服务系列/">微服务系列</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术知识图谱/">技术知识图谱</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构学习系列/">架构学习系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/测试框架系列/">测试框架系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络协议系列/">网络协议系列</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/认证与授权系列/">认证与授权系列</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">3</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2PC/">2PC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/3PC/">3PC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Adapter/">Adapter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/">Apache</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BASE/">BASE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Builder/">Builder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CAP/">CAP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS/">CentOS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul/">Consul</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul-template/">Consul-template</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECMAScript/">ECMAScript</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTPS/">HTTPS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK/">JDK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK1-8/">JDK1.8</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mockito/">Mockito</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/">NIO</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OAuth-2-0/">OAuth 2.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paxos/">Paxos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prototype/">Prototype</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RPC/">RPC</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raft/">Raft</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reactive-Streams/">Reactive Streams</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reactor/">Reactor</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reference/">Reference</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Registrator/">Registrator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/">RxJava</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-Boot/">SOFA-Boot</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-RPC/">SOFA-RPC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOFA-RPC/">SOFA_RPC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Singleton/">Singleton</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot-2-0/">Spring Boot 2.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Cloud/">Spring Cloud</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-WebFlux/">Spring WebFlux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thrift/">Thrift</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unique-ID/">Unique ID</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/">Web</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/">WebSocket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/异步/">异步</a><span class="tag-list-count">3</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/2PC/" style="font-size: 10px;">2PC</a> <a href="/tags/3PC/" style="font-size: 10px;">3PC</a> <a href="/tags/Adapter/" style="font-size: 10px;">Adapter</a> <a href="/tags/Android/" style="font-size: 13.33px;">Android</a> <a href="/tags/Apache/" style="font-size: 13.33px;">Apache</a> <a href="/tags/BASE/" style="font-size: 10px;">BASE</a> <a href="/tags/Builder/" style="font-size: 10px;">Builder</a> <a href="/tags/CAP/" style="font-size: 10px;">CAP</a> <a href="/tags/CentOS/" style="font-size: 10px;">CentOS</a> <a href="/tags/Consul/" style="font-size: 11.67px;">Consul</a> <a href="/tags/Consul-template/" style="font-size: 10px;">Consul-template</a> <a href="/tags/Docker/" style="font-size: 13.33px;">Docker</a> <a href="/tags/ECMAScript/" style="font-size: 11.67px;">ECMAScript</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/JDK/" style="font-size: 10px;">JDK</a> <a href="/tags/JDK1-8/" style="font-size: 11.67px;">JDK1.8</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/Java/" style="font-size: 18.33px;">Java</a> <a href="/tags/Mockito/" style="font-size: 10px;">Mockito</a> <a href="/tags/NIO/" style="font-size: 15px;">NIO</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/OAuth-2-0/" style="font-size: 10px;">OAuth 2.0</a> <a href="/tags/Paxos/" style="font-size: 10px;">Paxos</a> <a href="/tags/Prototype/" style="font-size: 10px;">Prototype</a> <a href="/tags/RPC/" style="font-size: 20px;">RPC</a> <a href="/tags/Raft/" style="font-size: 10px;">Raft</a> <a href="/tags/Reactive-Streams/" style="font-size: 11.67px;">Reactive Streams</a> <a href="/tags/Reactor/" style="font-size: 10px;">Reactor</a> <a href="/tags/Reference/" style="font-size: 10px;">Reference</a> <a href="/tags/Registrator/" style="font-size: 10px;">Registrator</a> <a href="/tags/RxJava/" style="font-size: 13.33px;">RxJava</a> <a href="/tags/SOFA-Boot/" style="font-size: 13.33px;">SOFA-Boot</a> <a href="/tags/SOFA-RPC/" style="font-size: 11.67px;">SOFA-RPC</a> <a href="/tags/SOFA-RPC/" style="font-size: 11.67px;">SOFA_RPC</a> <a href="/tags/Singleton/" style="font-size: 10px;">Singleton</a> <a href="/tags/Spring-Boot-2-0/" style="font-size: 10px;">Spring Boot 2.0</a> <a href="/tags/Spring-Cloud/" style="font-size: 11.67px;">Spring Cloud</a> <a href="/tags/Spring-WebFlux/" style="font-size: 11.67px;">Spring WebFlux</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/Thrift/" style="font-size: 16.67px;">Thrift</a> <a href="/tags/Unique-ID/" style="font-size: 10px;">Unique ID</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/分布式/" style="font-size: 15px;">分布式</a> <a href="/tags/异步/" style="font-size: 13.33px;">异步</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://weekly.manong.io/issues" target="_blank">码农周刊</a>
                    </li>
                
                    <li>
                        <a href="https://www.tuicool.com/mags" target="_blank">编程狂人</a>
                    </li>
                
                    <li>
                        <a href="http://ifeve.com" target="_blank">并发编程网</a>
                    </li>
                
                    <li>
                        <a href="https://juejin.im" target="_blank">掘金</a>
                    </li>
                
                    <li>
                        <a href="http://www.jianshu.com" target="_blank">简书</a>
                    </li>
                
                    <li>
                        <a href="https://github.com" target="_blank">Github</a>
                    </li>
                
                    <li>
                        <a href="https://stackoverflow.com" target="_blank">StackoverFlow</a>
                    </li>
                
                    <li>
                        <a href="http://www.infoq.com" target="_blank">Infoq</a>
                    </li>
                
                    <li>
                        <a href="https://segmentfault.com" target="_blank">SegmentFault</a>
                    </li>
                
                    <li>
                        <a href="http://www.importnew.com" target="_blank">ImportNew</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fas fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 Harrison Chen<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">Harrison Chen</a><br>
            
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1273891841'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s13.cnzz.com/z_stat.php%3Fid%3D1273891841%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>


        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>